

<%= render(:partial => "week_report") %>

<%= render (:partial => 'day_report')%>

<script type="text/javascript">
     $(document).ready(function () {
       jQuery('#daily-bars').tufteBar({
         data: [
		
      	<% @user.logged_working_days.each do |lwd| %>
			<%="[#{lwd.duration},{label:'#{ApplicationHelper::ABBR_DAYNAMES[lwd.wday.wday]}'}, {flag:'#{if lwd.duration < 420; 'Red'; else;'Grey'; end}'}]," %>
		<%end%>
		  [0, {label: ''}, {flag: 'White'}]
         ],
         barWidth: 0.8,
         barLabel:  function(index) { return '' },
         axisLabel: function(index) { return this[1].label },
         color:     function(index) { 
			switch (this[2].flag)
			{
			case 'Red':
			 return '#8B0000'
			  break;
			case 'White':
			 return '#000000'
			  break;
			default:
			 return '#828282'
			}; 
		}
       });
     });
   </script>

<!--div id="test">
	<% @user.logged_working_days.each do |lwd| %>
		<%="[#{lwd.duration},{label:'#{ApplicationHelper::ABBR_DAYNAMES[lwd.wday.wday]}'}, {flag:'#{if lwd.duration < 300; 'Red'; else;'Grey'; end}'}]," %>
	<%end%>
</div-->

<div class="clear"></div>

<div id='daily-bars' class='graph' style='width: 680px; height: 150px; margin: 20px;'></div>

<div class="clear"></div>

<div class="report daily">
	<h2>Your Daily Stats</h2>
	<table cellspacing="0">
		<thead>
			<th>Working Day</th>
			<th>Check In Time</th>
			<th>Check Out Time</th>
			<th>Duration in Minutes</th>
		</thead>
		<tbody>
			<% @user.logged_working_days.each do |lwd| %>
			<tr class = "<%= cycle("alt","white") -%>">
				<td> <%=lwd.wday %></td>
				<td> <%=lwd.check_in.strftime("%H:%M") %></td>
				<td><%=lwd.check_out.strftime("%H:%M") %></td>
				<td><%=lwd.duration %></td>
			</tr>
			<%end%>
		</tbody>
	</table>
</div>

<div class="clear"></div>
<% reset_cycle %>
<div class="report weekly">
	<h2>Your Weekly Stats </h2>
	<table cellspacing="0">
		<thead>
			<th>Week</th>
			<th># Working Days</th>
			<th># Hours Spent</th>
			<th>Daily Average</th>
		</thead>
		<tbody>
			<% @user.logged_working_weeks.each do |lww| %>
			<tr class = "<%= cycle("alt","white") -%>">
				<td> <%= lww %></td>
				<td> 5 </td>
				<td><%=to_time(week_completed(lww))%> </td>
				<td><%=to_time(week_average(lww))%></td>
			</tr>
			<%end%>
		</tbody>
	</table>
</div>



